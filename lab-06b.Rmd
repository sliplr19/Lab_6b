---
title: "Lab 06b - Simpson's paradox"
author: "Lindley Slipetz"
date: "3/8/2021"
output: github_document
---

### Load packages and data

```{r load-packages, message = FALSE, warning = FALSE}
library(tidyverse) 
#install.packages("mosaicData")
#install.packages("wesanderson")
library(mosaicData) 
library(wesanderson)
```

### Exercise 1

```{r load_data}
data(Whickham)
```
I think this is an observational study. This is because I highly doubt they introduced smoking to certain people as an experimental condition and saw if they died. Instead, I think they observed people who were already smokers and non-smokers to check their living status.

### Exercise 2


```{r nrow}
nrow(Whickham)
```
There are 1314 observations, which represent individuals.

### Exercise 3


```{r nrow}
ncol(Whickham)
```
There are three variables in this dataset: outcome (categorical), smoker (categorical), and age (discrete because it can only take on integer values).

For the visualization, I was originally going to do some pie charts for the categorical variables. After doing some reading, I am now convinced that pie charts can be difficult to read, so I should use something easier to compare: a bar graph.

```{r outcome_bar}
Whickham %>%
  ggplot(aes(x=outcome, fill = outcome)) +
  geom_bar() +
 scale_fill_manual(values=wes_palette(n=2, name="Darjeeling2"))+
  labs(title = "Outcome counts", x = "Outcome", y = "Count", fill = "Outcome")
```
```{r smoker_bar}
Whickham %>%
  ggplot(aes(x=smoker, fill = smoker)) +
  geom_bar() +
 scale_fill_manual(values=wes_palette(n=2, name="Royal1"))+
  labs(title = "Smoker counts", x = "Smoker status", y = "Count", fill = "Smoker status")
```
```{r smoker_bar}
Whickham %>%
  ggplot(aes(x=factor(age))) +
  geom_bar(stat = "count") +
 scale_fill_manual(values=wes_palette(n=1, name="Royal2"))+
  labs(title = "Age counts", y = "Count") +
  scale_x_discrete("Age", breaks = c(10, 20, 30, 40, 50, 60, 70, 80, 90, 100), labels = c("10", "20", "30", "40", "50", "60", "70", "80", "90", "100"))
```